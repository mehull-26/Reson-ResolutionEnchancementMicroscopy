# Richardson-Lucy with Gibson-Lanni PSF
# Optimized for fluorescence microscopy (oil immersion)

version: v1
experiment_name: "deconv_fluorescence"

enhancement:
  modules:
    # Pre-denoising (important for fluorescence)
    - name: "Bilateral Pre-denoising"
      type: BilateralFilter
      enabled: true
      params:
        d: 7
        sigma_color: 50
        sigma_space: 50
    
    # Richardson-Lucy with Gibson-Lanni PSF
    - name: "Richardson-Lucy Deconvolution"
      type: RichardsonLucy
      enabled: true
      params:
        iterations: 30                    # More iterations for fluorescence
        regularization: 0.002             # Higher regularization for noisy fluorescence
        clip_negative: true
        
        # Gibson-Lanni PSF (fluorescence-specific)
        psf_method: "gibson_lanni"
        psf_params:
          wavelength: 520                  # GFP emission wavelength
          numerical_aperture: 1.4          # Oil immersion 100x
          pixel_size: 0.065                # Typical sCMOS camera
          size: 41                         # Larger PSF for fluorescence
          ni: 1.518                        # Oil refractive index
          ns: 1.33                         # Sample (aqueous) refractive index
          ti: 150                          # Working distance in micrometers

# Input/Output configuration
io:
  input_format: auto
  output_format: tif
  output_bit_depth: 16
  normalize_input: true
  preserve_dtype: false

# Processing configuration
processing:
  convert_to_grayscale: false
  clip_output: true

# Metrics to compute
metrics:
  enabled: true
  compute:
    - sharpness
    - laplacian_variance
    - tenengrad_sharpness

# Visualization settings
visualization:
  plot_comparison: false
  plot_metrics: false
  figsize: [12, 6]
  dpi: 100

# Common Fluorescence Microscopy Settings:
# 
# Objectives:
#   - 60x/1.40 Oil: NA=1.40, ni=1.518
#   - 100x/1.40 Oil: NA=1.40, ni=1.518
#   - 63x/1.20 Water: NA=1.20, ni=1.33
#   - 40x/0.95 Dry: NA=0.95, ni=1.0
#
# Common Fluorophores (emission wavelength):
#   - DAPI: 450 nm (blue, nuclear stain)
#   - GFP: 520 nm (green)
#   - YFP: 530 nm (yellow-green)
#   - mCherry/RFP: 610 nm (red)
#   - Cy5: 670 nm (far-red)
#
# Camera Pixel Sizes:
#   - Typical sCMOS: 6.5 µm physical → 0.065 µm with 100x
#   - Typical CCD: 6.45 µm physical → 0.0645 µm with 100x
#   - Calculate: physical_pixel_size / magnification = effective_pixel_size
