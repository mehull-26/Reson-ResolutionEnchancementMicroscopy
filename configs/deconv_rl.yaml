# Richardson-Lucy Deconvolution Configuration
# Optimized for fluorescence microscopy with moderate blur

version: v1
experiment_name: "deconv_richardson_lucy"

enhancement:
  modules:
    # Optional: Pre-denoising (recommended for noisy images)
    - name: "Pre-denoising"
      type: BilateralFilter
      enabled: true
      params:
        d: 5
        sigma_color: 30
        sigma_space: 30
    
    # Richardson-Lucy Deconvolution
    - name: "Richardson-Lucy Deconvolution"
      type: RichardsonLucy
      enabled: true
      params:
        iterations: 20                    # Number of iterations (10-50)
        regularization: 0.001              # Prevents noise amplification (0.0-0.01)
        clip_negative: true                # Ensure non-negative result
        convergence_threshold: null        # Optional: stop if converged
        
        # PSF Configuration
        psf_method: "gaussian"             # 'gaussian', 'airy', 'gibson_lanni', 'blind', 'custom'
        psf_params:
          wavelength: 520                  # Emission wavelength in nm (e.g., 520 for GFP)
          numerical_aperture: 1.4          # Objective NA (1.4 for oil immersion 100x)
          pixel_size: 0.065                # Camera pixel size in micrometers
          size: 31                         # PSF size (odd number, 21-51)
    
    # Optional: Post-sharpening (usually not needed after deconvolution)
    - name: "Post-sharpening"
      type: UnsharpMasking
      enabled: false
      params:
        sigma: 1.0
        amount: 0.5
        threshold: 0.0

# Input/Output configuration
io:
  input_format: auto
  output_format: tif
  output_bit_depth: 16
  normalize_input: true
  preserve_dtype: false

# Processing configuration
processing:
  convert_to_grayscale: false
  clip_output: true

# Metrics to compute
metrics:
  enabled: true
  compute:
    - sharpness
    - laplacian_variance
    - brenner_sharpness

# Visualization settings
visualization:
  plot_comparison: false
  plot_metrics: false
  figsize: [12, 6]
  dpi: 100

# Notes:
# 1. For heavily blurred images, increase iterations to 30-50
# 2. For noisy images, increase regularization to 0.005-0.01
# 3. For oil immersion objectives, NA typically 1.3-1.4
# 4. For water immersion objectives, NA typically 1.0-1.2
# 5. For dry objectives, NA typically 0.3-0.95
# 6. Typical emission wavelengths:
#    - DAPI (blue): 450 nm
#    - GFP (green): 520 nm
#    - RFP (red): 600 nm
#    - Cy5 (far-red): 670 nm
