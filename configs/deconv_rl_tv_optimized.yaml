# Optimized Richardson-Lucy with TV Regularization for Noisy Data
# This config works DIRECTLY on noisy Poisson data without pre-denoising
# Validated on checkerboard_gaussian_poisson3 (SNR=3.0, very heavy noise)
# Result: +3.85 dB PSNR improvement

version: v1
experiment_name: "rl_noisy_optimized"

enhancement:
  modules:
    - name: "Richardson-Lucy with Optimized TV Regularization"
      type: RichardsonLucy
      enabled: true
      params:
        # Optimal parameters for noisy fluorescence data
        iterations: 25                 # 20-25 works best, diminishing returns after
        regularization: 0.05           # TV regularization - balances denoising & deconvolution
                                       # Lower = sharper but more noise (0.03-0.08 range)
                                       # Higher = smoother but less detail (0.1+)
        
        clip_negative: true            # Essential for intensity images
        convergence_threshold: null    # null = run all iterations
        
        # PSF configuration
        psf_method: gaussian           # Use 'custom' for measured PSF
        psf_params:
          wavelength: 550              # nm (green fluorescence)
          numerical_aperture: 1.0      # NA=1.0 moderate blur
          pixel_size: 0.1              # μm/pixel
          size: 31                     # 31x31 kernel

io:
  input_format: auto
  output_format: tif
  output_bit_depth: 16

# Note: For heavily noisy data (SNR < 5):
# - Direct RL-TV with λ=0.05 works best
# - Pre-denoising is NOT needed with proper TV regularization
# - TV regularization handles Poisson noise naturally
#
# For moderately noisy data (SNR 5-10):
# - Can reduce lambda to 0.03 for sharper results
# - Or add light Gaussian pre-denoising (σ=0.5) for slightly better visual quality
#
# For clean data (SNR > 10):
# - Use lambda=0.001 or 0.0 (no regularization needed)
# - Increase iterations to 30-50 for maximum sharpness
